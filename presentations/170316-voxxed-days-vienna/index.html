<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Java EE Microservices with</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js-3.1.0/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js-3.1.0/css/theme/wildfly-swarm.css" id="theme" /><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#a2a2ff}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#ffff59;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#7d9eff;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#00d2d2}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#ee78e6}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#00d2d2}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#11dd3d}
.CodeRay .inline-delimiter{color:#11dd3d}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#00d2d2}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#ee78e6;font-weight:bold}
.CodeRay .key{color:#ee78e6}
.CodeRay .key .delimiter{color:#ee78e6}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#ee78e6}
.CodeRay .regexp .content{color:#ee78e6}
.CodeRay .regexp .modifier{color:#ee78e6}
.CodeRay .regexp .char{color:#11dd3d}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#11dd3d}
.CodeRay .string .char{color:#11dd3d}
.CodeRay .string .delimiter{color:#11dd3d}
.CodeRay .shell{color:#11dd3d}
.CodeRay .shell .delimiter{color:#11dd3d}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#00d2d2}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:none}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js-3.1.0/lib/css/zenburn.css" rel="stylesheet" /><script>document.write( '<link rel="stylesheet" href="reveal.js-3.1.0/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section class="title"><h1>Java EE Microservices with</h1><div class="imageblock" style=""><img src="images/swarm_logo_200px.png" alt="swarm logo 200px" /></div>
<div class="paragraph"><p>Peter Palaga, Red Hat</p></div><p><small></small></p></section>
<section id="about_me"><h2>About me</h2><div class="paragraph text-left"><p>Peter Palaga</p></div>
<div class="ulist"><ul><li><p>Senior sustaining engineer for JBoss EAP at Red Hat</p></li><li><p>Occasional contributor to WildFly Swarm</p></li><li><p>Author of srcdeps <a href="https://github.com/srcdeps/srcdeps-maven" class="bare">https://github.com/srcdeps/srcdeps-maven</a></p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>EAP stands for Enterprise Application Platform</p></li><li><p>It is the Java EE Application Server with commercial suppord from Red Hat</p></li><li><p>Based on the community project called WildFly</p></li><li><p>&#8230;&#8203; and there is my twitter handle at the bottom</p></li></ul></div></aside></section>
<section id="agenda"><h2>Agenda</h2><div class="ulist"><ul><li><p>Java EE</p></li><li><p>Microservices architectures</p></li><li><p>WildFly Swarm</p><div class="ulist"><ul><li><p>Uberjar, Fractions</p></li><li><p>Demo: "Swarmify" a traditional EE Application</p></li><li><p>Configuration</p></li></ul></div></li><li><p>Advanced topics</p><div class="ulist"><ul><li><p>Secure access (Keycloak), Service registration and discovery,
Load Balancing &amp; Circuit Breaking, and API documentation (Swagger).</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Next slide: To warm up, please raise your hand&#8230;&#8203;</p></div></aside></section>
<section><section id="java_ee"><h2>Java EE</h2><div class="paragraph"><p>Please raise your hand if you ever wrote or maintained</p></div><div class="ulist"><ul><li class="fragment"><p>Java Servlet</p></li><li class="fragment"><p>EJB</p></li><li class="fragment"><p>JAX-RS Endpoint</p></li><li class="fragment"><p>Persistence with Hibernate</p></li></ul></div><aside class="notes"><div class="paragraph"><p>Next slide: So what is Java EE?</p></div></aside></section><section id="java_ee_2"><h2>Java EE</h2><div class="paragraph"><p>(application developer&#8217;s perspective)</p></div>
<div class="ulist"><ul><li><p>A set of API specifications</p><div class="ulist"><ul><li><p>Servlet, EJB, JAX-RS, JPA, JTA, CDI, JMS, &#8230;&#8203;</p></li></ul></div></li><li><p>Packaged together as an Application Server</p></li><li><p>Several implementations</p><div class="ulist"><ul><li><p>WildFly/JBoss EAP, WebSphere, WebLogic, &#8230;&#8203;</p></li></ul></div></li><li><p>History since 1999, latest EE 7 from 2013, MicroProfile</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Different things to different people&#8230;&#8203;</p></div>
<div class="ulist"><ul><li><p>MicroProfile: a new effort to refine the enterprise Java specifications for use in microservices</p></li><li><p>includes: JAX-RS JSON-P CDI</p></li></ul></div></aside></section></section>
<section><section id="microservices"><h2>Microservices</h2><div class="paragraph text-left"><p>Based on recent inovations</p></div><div class="ulist text-left"><ul><li><p>CI/CD</p></li><li><p>Linux containers</p></li><li><p>DevOps culture</p></li></ul></div><div class="paragraph text-left"><p>Divide the functionality into reasonably small units, a.k.a. Microservices</p></div><div class="ulist text-left"><ul><li><p>Communication through REST or other language independent protocols</p></li><li><p>Isolation: Languages, Runtimes, Datastores, Release cycles, (DevOps) teams</p></li></ul></div><aside class="notes"><div class="paragraph"><p>New approaches to software architecture</p></div>
<div class="paragraph"><p>There is a few things in both technology and process methodology that made the shift possible:</p></div>
<div class="ulist"><ul><li><p>Build and Deployment automation</p><div class="ulist"><ul><li><p>Smaller changesets go faster to production</p></li></ul></div></li><li><p>Immutable, minimalistic images practical from many PoV</p><div class="ulist"><ul><li><p>Fast provisioning</p></li><li><p>Fast boot &#8594; fast scale up and down</p></li><li><p>Less code &#8594; less bugs and less security problems</p></li></ul></div></li><li><p>DevOps one, preferably small team responsible for the whole lifecycle of an appliction</p><div class="ulist"><ul><li><p>from coding, through, build, QA, deploy and run to monitoring</p></li></ul></div></li></ul></div></aside></section><section id="why_java_ee_still_matters"><h2>Why Java EE still matters?</h2><div class="ulist"><ul><li><p>Robust, mature</p></li><li><p>Well understood (performance, scalability)</p></li><li><p>Standards compliant</p></li><li><p>Integrations</p></li><li><p>Investments (workforce, code in production)</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>First, there is a lot of reasons</p></div></aside></section><section id="how_can_java_ee_fit_in"><h2>How can Java EE fit in?</h2><div class="paragraph"><p>Java EE App Servers have to carry all APIs to get certified</p></div>
<div class="ulist"><ul><li><p>Large in terms of disk space</p></li><li><p>(Some) slow to boot</p></li><li><p>(Some) require a lot of memory</p></li></ul></div></section></section>
<section><section id="_but_my_app_does_not_need_all_of_the_apis"><h2>&#8230;&#8203; but my app does not need all of the APIs!</h2></section><section id="welcome_wildfly_swarm"><h2>Welcome WildFly Swarm!</h2></section><section id="what_is_wildfly_swarm"><h2>What is WildFly Swarm?</h2><div class="ulist"><ul><li><p>Open source project sponsored by Red Hat</p></li><li><p>A decomposition on WildFly Java EE Application Server</p></li><li><p>Take only the APIs you need (Just enough AppServer)</p></li><li><p>Package into a single runnable JAR (Uberjar) together with your application</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>Decomposition not that hard with WildFly b/c it already is well modularized.</p></li><li><p>The Java EE APIs map to subsystems</p></li></ul></div></aside></section></section>
<section><section id="wildfly_swarm_core_concepts"><h2>WildFly Swarm core concepts</h2></section><section id="uberjar"><h2>Uberjar</h2><div class="paragraph"><p>A self-contained JAR</p></div>
<div class="ulist"><ul><li><p>Your application</p></li><li><p>The parts of WildFly necessary to run it</p></li><li><p>An internal Maven repository of dependencies</p></li><li><p>A piece of bootstrap code</p></li></ul></div></section><section id="hollow_uberjar"><h2>Hollow Uberjar</h2><div class="ulist"><ul><li><p>Like Uberjar but contains no application code.</p><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="shell language-shell">java -jar myruntime-hollow-swarm.jar my-app.war</code></pre></div></div></li><li><p>Useful with layered Linux containers:</p><div class="ulist"><ul><li><p>Layer <code>n</code>: Hollow Uberjar runtime</p></li><li><p>Layer <code>n+1</code>: the application</p></li></ul></div></li><li><p>Reduces the provisioning overhead and boot time</p></li><li><p>This is how WildFly Swarm implements MicroProfile</p></li></ul></div></section><section id="fractions"><h2>Fractions</h2><div class="ulist"><ul><li><p>Well-defined collections of capabilities</p></li><li><p>Expressed as Maven GAVs</p></li><li><p>Autodetected at build time or explicitly declared</p></li><li><p>Configurable, with reasonable defaults</p></li><li><p>May map to</p><div class="ulist"><ul><li><p>WildFly subsystems (read: Java EE APIs)</p></li><li><p>Any external code (Jolokia, Netflix Ribbon, Swagger, &#8230;&#8203;)</p></li></ul></div></li><li><p>List of Fractions <a href="https://reference.wildfly-swarm.io/v/2017.3.3/" class="bare">https://reference.wildfly-swarm.io/v/2017.3.3/</a></p></li></ul></div></section></section>
<section><section id="how_to_swarmify_a_war_1_2"><h2>How to swarmify a WAR (1/2)</h2><div class="paragraph"><p>Let&#8217;s have a traditional Java EE application</p></div><div class="paragraph"><p><a href="https://github.com/javaee-samples/javaee7-simple-sample" class="bare">https://github.com/javaee-samples/javaee7-simple-sample</a></p></div><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;project&gt;</span>
  ...
  <span class="tag">&lt;name&gt;</span>javaee7-simple-sample<span class="tag">&lt;/name&gt;</span>
  <span class="tag">&lt;packaging&gt;</span>war<span class="tag">&lt;/packaging&gt;</span>
  ...
  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>javax<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>javaee-api<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;version&gt;</span>7.0<span class="tag">&lt;/version&gt;</span>
      <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
  ...</code></pre></div></div></section><section id="how_to_swarmify_a_war_2_2"><h2>How to swarmify a WAR (2/2)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;plugin&gt;</span>  <span class="comment">&lt;!-- Add the wildfly-swarm-plugin --&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>wildfly-swarm-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>2017.3.3<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;executions&gt;</span>
    <span class="tag">&lt;execution&gt;</span>
      <span class="tag">&lt;goals&gt;</span>
        <span class="tag">&lt;goal&gt;</span>package<span class="tag">&lt;/goal&gt;</span>
      <span class="tag">&lt;/goals&gt;</span>
    <span class="tag">&lt;/execution&gt;</span>
  <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="shell language-shell">mvn package                                <span class="comment"># build</span>
ls target                                  <span class="comment"># check what has</span>
... <strong>javaee7-simple-sample-swarm.jar</strong> ...    <span class="comment">#   been built</span>
java -jar javaee7-simple-sample-swarm.jar  <span class="comment"># run the uberjar</span></code></pre></div></div></section><section id="where_are_the_fractions"><h2>Where are the Fractions?</h2><div class="paragraph"><p>Autodetected by <code>wildfly-swarm-plugin</code> <strong>or</strong> declared explicitly:</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span> <span class="comment">&lt;!-- under dependencyManagement --&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>bom-all<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>2017.3.3<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
  <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
...
<span class="tag">&lt;dependencies&gt;</span> <span class="comment">&lt;!-- Fraction GAVs --&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>jaxrs<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>cdi<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
  ...</code></pre></div></div></section></section>
<section id="start_from_scratch"><h2>Start from scratch</h2><div class="paragraph"><p><a href="http://wildfly-swarm.io/generator/" class="bare">http://wildfly-swarm.io/generator/</a></p></div>
<div class="imageblock" style=""><img src="images/wildlfy-swarm-generator.png" alt="WildFly Swarm Generator" /></div></section>
<section><section id="wildfly_vs_wildfly_swarm"><h2>WildFly vs. WildFly Swarm</h2></section><section id="disk_size"><h2>Disk size</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead><tr><th class="tableblock halign-left valign-top">WildFly</th><th class="tableblock halign-left valign-top">WildFly Swarm (Uberjar)</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">148 MB wildfly-master.zip
</p><p class="tableblock">177 MB unzipped</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">36 MB plain Servlet
</p><p class="tableblock">47 MB above + JAX-RS
</p><p class="tableblock">86 MB above + CDI
</p><p class="tableblock">100 MB above + JPA/Hibernate</p></td></tr></tbody></table></section><section id="provisioning"><h2>Provisioning</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead><tr><th class="tableblock halign-left valign-top">WildFly</th><th class="tableblock halign-left valign-top">WildFly Swarm</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Copy and unzip WildFly
</p><p class="tableblock">Boot
</p><p class="tableblock">Configure (datasources, &#8230;&#8203;)
</p><p class="tableblock">Deploy the app</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Copy the uberjar to the server
</p><p class="tableblock">Run the uberjar</p></td></tr></tbody></table></section><section id="missing_parts"><h2>Missing parts</h2><div class="paragraph text-left"><p>WildFly Swarm:</p></div>
<div class="ulist"><ul><li><p>Will not run with a security manager</p></li><li><p>No EAR deployments</p></li><li><p>No clustering</p><div class="ulist"><ul><li><p>Session replication, domain management, distributed caches, message broker</p></li></ul></div></li></ul></div>
<div class="paragraph text-left"><p>Areas open for contributions from the community</p></div>
<aside class="notes"><div class="paragraph"><p>A different mindset behind µservices</p></div>
<div class="ulist"><ul><li><p>µservices should be stateless &#8594; no need for (domain) management</p></li><li><p>Instances up and down quickly</p></li></ul></div>
<div class="paragraph"><p>But still:
* Swarm nodes free to communicate with clusters managed
  separatelly, such as distributed cache (Infinispan), Message Brokers, &#8230;&#8203;
* All kinds of clustering technically possible, because there is
  WF under the hood. Area open for community contributions :)</p></div></aside></section></section>
<section><section id="configuration"><h2>Configuration</h2></section><section id="java_api"><h2>Java API</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
  <span class="keyword">new</span> Swarm().fraction(
    <span class="keyword">new</span> DatasourcesFraction()
      .jdbcDriver(<span class="string"><span class="delimiter">&quot;</span><span class="content">h2</span><span class="delimiter">&quot;</span></span>, (d) -&gt; {
        d.driverClassName(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.h2.Driver</span><span class="delimiter">&quot;</span></span>);
        d.xaDatasourceClass(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.h2.jdbcx.JdbcDataSource</span><span class="delimiter">&quot;</span></span>);
        d.driverModuleName(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.h2database.h2</span><span class="delimiter">&quot;</span></span>);
      })
      .dataSource(<span class="string"><span class="delimiter">&quot;</span><span class="content">ExampleDS</span><span class="delimiter">&quot;</span></span>, (ds) -&gt; {
        ds.driverName(<span class="string"><span class="delimiter">&quot;</span><span class="content">h2</span><span class="delimiter">&quot;</span></span>);
        ds.connectionUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:h2:mem:test;</span><span class="delimiter">&quot;</span></span>
          + <span class="string"><span class="delimiter">&quot;</span><span class="content">DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</span><span class="delimiter">&quot;</span></span>);
        ds.userName(<span class="string"><span class="delimiter">&quot;</span><span class="content">sa</span><span class="delimiter">&quot;</span></span>); ds.password(<span class="string"><span class="delimiter">&quot;</span><span class="content">sa</span><span class="delimiter">&quot;</span></span>);
      })
  ).start().deploy();
}</code></pre></div></div>
<aside class="notes"><div class="ulist"><ul><li><p>The fractions that map to WildFly subsystems can be configured this way.</p></li><li><p>The configuration model is an equivalent to the WildFly management model.</p></li></ul></div></aside></section><section id="stages"><h2>Stages</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="yaml language-yaml"><span class="key">logger</span>:               <span class="comment"># project-defaults.yml file</span>
  <span class="key">level</span>: <span class="string"><span class="content">DEBUG</span></span>
<span class="key">swarm</span>:
  <span class="key">port</span>:
    <span class="key">offset</span>: <span class="string"><span class="content">10</span></span>
<span class="head"><span class="head">---</span></span>
<span class="key">project</span>:              <span class="comment"># To specify the &quot;development&quot; stage,</span>
  <span class="key">stage</span>: <span class="string"><span class="content">development</span></span>  <span class="comment"># run with</span>
<span class="key">logger</span>:               <span class="comment">#   java -jar my-swarm.jar -S development</span>
  <span class="key">level</span>: <span class="string"><span class="content">DEBUG</span></span>
<span class="key">swarm</span>:
  <span class="key">port</span>:
    <span class="key">offset</span>: <span class="string"><span class="content">50</span></span>
<span class="head"><span class="head">---</span></span>
<span class="key">project</span>:
  <span class="key">stage</span>: <span class="string"><span class="content">production</span></span>
<span class="key">logger</span>:
  <span class="key">level</span>: <span class="string"><span class="content">INFO</span></span>
<span class="head"><span class="head">...</span></span></code></pre></div></div>
<aside class="notes"><div class="ulist"><ul><li><p>To set defaults</p></li><li><p>allow environment dependent customization</p></li><li><p>Everything in <code>project-defaults.yml</code>
or <code>project-defaults.yml</code> plus separate <code>project-mystage.yml</code> files</p></li></ul></div></aside></section><section id="_code_standalone_xml_code"><h2><code>standalone.xml</code></h2><div class="ulist"><ul><li><p>Useful when migrating from a traditional WildFly deployment</p></li><li><p>Either</p><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="shell language-shell">java -jar my-swarm.jar -c my-standalone.xml</code></pre></div></div></li><li><p>Or package <code>standalone.xml</code> in your uberjar by placing it to <code>src/main/resources</code></p></li><li><p>Ensure that you have all subsystem fractions that you configure</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Autodetection is noto looking into your standalone.xml</p></div></aside></section><section id="command_line_arguments_and_system_properties"><h2>Command line arguments and system properties</h2><div class="ulist"><ul><li><p><code>-b 192.168.1.104</code> or <code>-Dswarm.bind.address=192.168.1.104</code> to bind to a specific network interface</p></li><li><p><code>-Dswarm.port.offset=42</code> to shift ports - e.g. <code>8080 &#8594; 8122</code></p></li><li><p><code>-Dswarm.context.path=/my-app</code> - note that the default is <code>/</code></p></li></ul></div>
<div class="paragraph"><p>... and many others</p></div>
<div class="paragraph small"><small>Full reference: <a href="https://wildfly-swarm.gitbooks.io/wildfly-swarm-users-guide/content/configuration_properties.html" class="bare">https://wildfly-swarm.gitbooks.io/wildfly-swarm-users-guide/content/configuration_properties.html</a></small></div></section></section>
<section><section id="advanced_topics"><h2>Advanced topics</h2></section><section id="secure_access_with_keycloak"><h2>Secure access with Keycloak</h2><aside class="notes"><div class="paragraph"><p>Next: Who knows Keycloak?</p></div></aside></section><section id="what_is_keycloak"><h2>What is Keycloak</h2><div class="ulist"><ul><li><p>JBoss community project</p></li><li><p>Single sign-on (SSO) server and identity broker</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>SAML, OAuth, OpenID, various Social Logins, LDAP/Active Directory integration</p></div></aside></section><section id="how_to_secure_with_keycloak"><h2>How to secure with Keycloak</h2><table>
<tr>
  <td colspan="2" style="border-bottom:none">
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span> <span class="comment">&lt;!-- the keycloak client fraction in pom.xml --&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>keycloak<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></div></div>
  </td>
</tr>
<tr>
  <td>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="yaml language-yaml"><span class="comment"># project-defaults.yml</span>
<span class="key">swarm</span>:
 <span class="key">deployment</span>:
  <span class="key">example-keycloak.war</span>:
   <span class="key">web</span>:
    <span class="key">login-config</span>:
     <span class="key">auth-method</span>: <span class="string"><span class="content">KEYCLOAK</span></span>
    <span class="key">security-constraints</span>:
     - <span class="string"><span class="content">url-pattern: /secured</span></span>
       <span class="key">methods</span>: <span class="string"><span class="content">[GET]</span></span>
       <span class="key">roles</span>: <span class="string"><span class="content">[admin]</span></span></code></pre></div></div>
  </td>
  <td>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="javascript language-javascript"><span class="comment">/* WEB-INF/keycloak.json */</span>
{
<span class="key"><span class="delimiter">"</span><span class="content">realm</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">wildfly-swarm-keycloak-example</span><span class="delimiter">"</span></span>,
<span class="key"><span class="delimiter">"</span><span class="content">bearer-only</span><span class="delimiter">"</span></span>: <span class="predefined-constant">true</span>,
<span class="key"><span class="delimiter">"</span><span class="content">auth-server-url</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">http://localhost:8180/auth</span><span class="delimiter">"</span></span>,
<span class="key"><span class="delimiter">"</span><span class="content">ssl-required</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">external</span><span class="delimiter">"</span></span>,
<span class="key"><span class="delimiter">"</span><span class="content">resource</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">wildfly-swarm-keycloak-example</span><span class="delimiter">"</span></span>
}</code></pre></div></div>
  </td>
</tr>
</table>
<div class="paragraph small"><small><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/security/keycloak" class="bare">https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/security/keycloak</a></small></div></section></section>
<section><section id="service_registration"><h2>Service registration</h2><img src="images/registry.png" alt="Service Registry" width="350" style="position:absolute;right:-5px;z-index:1000"><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="comment">&lt;!-- pom.xml --&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>topology-consul<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></div></div><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="comment">/* Inside main() method */</span>
JAXRSArchive deployment = ...
<span class="comment">/* register */</span>
deployment.as(TopologyArchive.class)
    .advertise(<span class="string"><span class="delimiter">&quot;</span><span class="content">my-time-service</span><span class="delimiter">&quot;</span></span>);</code></pre></div></div><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="shell language-shell">java -Dswarm.consul.url=http://127.0.0.1:8500 -jar *-swarm.jar</code></pre></div></div><div class="paragraph small"><small><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/ribbon-consul" class="bare">https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/ribbon-consul</a></small></div></section><section id="service_discovery"><h2>Service discovery</h2><div class="ulist"><ul><li><p>Either directly through <code>ConsulClient.getAgentServices()</code></p></li><li><p>Or via Netflix Ribbon integration</p></li></ul></div></section></section>
<section><section id="netflix_ribbon"><h2>Netflix Ribbon</h2><div class="paragraph"><p>A REST inter-process communication library</p></div><div class="ulist"><ul><li><p>Client-side load-balancing to other services</p><div class="ulist"><ul><li><p>Several implementations: round Robin, response time weighted, random, &#8230;&#8203;</p></li></ul></div></li><li><p>Integration with Service Registries</p><div class="ulist"><ul><li><p>Services referenced by name rather than host</p></li></ul></div></li><li><p>Built-in failure resiliency via Hystrix</p></li></ul></div></section><section id="netflix_ribbon_fraction"><h2>Netflix Ribbon Fraction</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="comment">&lt;!-- pom.xml --&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>ribbon<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></div></div></section><section id="netflix_ribbon_service_client"><h2>Netflix Ribbon service client</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java">                                         <span class="comment">//    discovery by</span>
<span class="annotation">@ResourceGroup</span>( name=<span class="string"><span class="delimiter">&quot;</span><span class="content">my-time-service</span><span class="delimiter">&quot;</span></span> ) <span class="comment">// &lt;- service name</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TimeService</span> {           <span class="comment">//    lookup done</span>
                                         <span class="comment">//    by Consul fraction</span>
    <span class="annotation">@TemplateName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">currentTime</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Http</span>(
            method = Http.HttpMethod.GET,
            uri = <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>
    )
    <span class="annotation">@Hystrix</span>(
            fallbackHandler = TimeFallbackHandler.class
    )
    RibbonRequest&lt;ByteBuf&gt; currentTime();

                           <span class="comment">// Ribbon can provide an implementation</span>
                           <span class="comment">// of the TimeService</span>
    TimeService INSTANCE = Ribbon.from(TimeService.class);
}</code></pre></div></div>
<div class="paragraph small"><small><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/ribbon-consul" class="bare">https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/ribbon-consul</a></small></div>
<aside class="notes"><div class="ulist"><ul><li><p>Hystrix has to do with Fault tolerance and resilience</p></li><li><p>Implements the Circuit Breaker design patterns</p></li></ul></div>
<div class="paragraph"><p>It allows:</p></div>
<div class="ulist"><ul><li><p>Fail fast and rapidly recover</p></li><li><p>Prevent cascading failures through Fallback options</p></li><li><p>Latency tolerance logic</p></li><li><p>Fault tolerance logic</p></li></ul></div></aside></section></section>
<section><section id="swagger_api_documentation"><h2>Swagger API Documentation</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="comment">&lt;!-- pom.xml --&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.wildfly.swarm<span class="tag">&lt;/groupId&gt;</span> <span class="comment">&lt;!-- typically      --&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>swagger<span class="tag">&lt;/artifactId&gt;</span>     <span class="comment">&lt;!-- in combination --&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>                          <span class="comment">&lt;!-- with jaxrs     --&gt;</span></code></pre></div></div><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="comment">/* Inside main() method */</span>
SwaggerArchive archive =
    ShrinkWrap.create(SwaggerArchive.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">swagger-app.war</span><span class="delimiter">&quot;</span></span>);
<span class="comment">/* Tell swagger where our resources are */</span>
archive.setResourcePackages(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.myorg.myresources</span><span class="delimiter">&quot;</span></span>);</code></pre></div></div><div class="paragraph small"><small><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/jaxrs/swagger" class="bare">https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/jaxrs/swagger</a></small></div></section><section id="get_the_api_documentation"><h2>Get the API Documentation</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="shell language-shell">curl http://localhost:8080/swagger.json</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="json language-json">{   <span class="key"><span class="delimiter">&quot;</span><span class="content">swagger</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">info</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0.0</span><span class="delimiter">&quot;</span></span>},
    <span class="key"><span class="delimiter">&quot;</span><span class="content">host</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost:8080</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">basePath</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/swagger</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">tags</span><span class="delimiter">&quot;</span></span>:[{<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">time</span><span class="delimiter">&quot;</span></span>}],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">schemes</span><span class="delimiter">&quot;</span></span>:[<span class="string"><span class="delimiter">&quot;</span><span class="content">http</span><span class="delimiter">&quot;</span></span>],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">paths</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">/time/now</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">get</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">tags</span><span class="delimiter">&quot;</span></span>:[<span class="string"><span class="delimiter">&quot;</span><span class="content">time</span><span class="delimiter">&quot;</span></span>],
                <span class="key"><span class="delimiter">&quot;</span><span class="content">summary</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Get the current time</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Returns the time as a string</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">operationId</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">get</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">produces</span><span class="delimiter">&quot;</span></span>:[<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>],
                <span class="key"><span class="delimiter">&quot;</span><span class="content">parameters</span><span class="delimiter">&quot;</span></span>:[],
                <span class="key"><span class="delimiter">&quot;</span><span class="content">responses</span><span class="delimiter">&quot;</span></span>: {
<span class="error">.</span><span class="error">.</span><span class="error">.</span></code></pre></div></div></section></section>
<section id="wildfly_swarm_recap"><h2>WildFly Swarm Recap</h2><div class="ulist"><ul><li><p>Just enough Application Server</p></li><li><p>Uberjar or Hollow uberjar</p></li><li><p>Fractions to require and configure capabilites</p></li><li><p>WildFly Swarm Plugins for Maven and Gradle</p></li></ul></div></section>
<section id="keep_in_touch"><h2>Keep in touch</h2><div class="ulist"><ul><li><p>Documentation <a href="http://wildfly-swarm.io/" class="bare">http://wildfly-swarm.io/</a></p></li><li><p>Examples <a href="https://github.com/wildfly-swarm/wildfly-swarm-examples" class="bare">https://github.com/wildfly-swarm/wildfly-swarm-examples</a></p></li><li><p>Forum <a href="https://groups.google.com/forum/#!forum/wildfly-swarm" class="bare">https://groups.google.com/forum/#!forum/wildfly-swarm</a></p></li><li><p>IRC channel <a href="https://webchat.freenode.net/">#wildfly-swarm</a> at freenode</p></li><li><p>Issues <a href="https://issues.jboss.org/projects/SWARM" class="bare">https://issues.jboss.org/projects/SWARM</a></p></li><li><p>Twitter <a href="https://twitter.com/wildflyswarm">@wildflyswarm</a></p></li></ul></div></section></div>
                      <div class="footer">
                        <img src="images/swarm_logo.png" class="left" />
                        <a href="https://twitter.com/ppalaga">@ppalaga</a>
                        <img src="images/Red_Hat_RGB_reverse.svg" class="right" />
                      </div>
                      <div class="conf-banner">
                        <img src="images/voxxed-days-vienna.png" />
                      </div></div><script src="reveal.js-3.1.0/lib/js/head.min.js"></script><script src="reveal.js-3.1.0/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: false,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: false,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'wildfly-swarm',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js-3.1.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js-3.1.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js-3.1.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js-3.1.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js-3.1.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});Reveal.addEventListener('slidechanged', function(event) {
    if (Reveal.isFirstSlide()) {
        document.querySelector('.reveal .conf-banner').style.display = 'block';
        document.querySelector('.reveal .footer').style.display = 'none';
    } else {
        document.querySelector('.reveal .conf-banner').style.display = 'none';
        document.querySelector('.reveal .footer').style.display = 'block';
    }
});
Reveal.addEventListener( 'ready', function( event ) {
    if (Reveal.isFirstSlide()) {
        document.querySelector('.reveal .conf-banner').style.display = 'block';
        document.querySelector('.reveal .footer').style.display = 'none';
    } else {
        document.querySelector('.reveal .conf-banner').style.display = 'none';
        document.querySelector('.reveal .footer').style.display = 'block';
    }
});</script></body></html>